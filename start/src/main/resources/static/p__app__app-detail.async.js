"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[105],{47852:function(le,A,r){r.r(A);var L=r(77117),M=r.n(L),R=r(13448),Z=r.n(R),K=r(74815),W=r.n(K),S=r(28152),y=r.n(S),v=r(93236),k=r(91570),j=r(9327),s=r(82087),C=r(95020),x=r(59696),a=r(91753),N=r(30301),Y=r(80442),t=r(88811),d=r(56476),G=r(69416),H=r(48491),b=r(9069),$=r(5726),I=r.n($),e=r(62086),O=k.Z.Paragraph,p=j.Z.Option,w=function(i){var o,m=i.dispatch,u=i.appDetail,P=i.clusterList,V=(0,b.useParams)(),B=V.id,z=(0,v.useState)(!1),f=y()(z,2),J=f[0],g=f[1],Q=s.Z.useForm(),X=y()(Q,1),q=X[0];(0,v.useEffect)(function(){m({type:"app/getAppDetail",payload:{id:B}})},[m,B]),(0,v.useEffect)(function(){m({type:"cluster/listAll"})},[m]);var ee=function(){g(!0)},U=function(){g(!1)},ue=function(n){console.log("Received values:",n),m({type:"app/createAppEnv",payload:{appId:B,env:{env:n.env,clusterId:n.clusterId,envName:n.envName,needApproval:n.needApproval,autoScaling:n.autoScaling,domains:n.domains,resourceStrategy:{replicas:n.replicas,cpu:n.cpu,memory:n.memory,maxCpu:n.maxCpu,maxMemory:n.maxCpu}}}}),U()};return console.log("clusters",P),(0,e.jsxs)(C.Z,{title:"".concat(u==null?void 0:u.appName," \u8BE6\u60C5\u9875"),extra:(0,e.jsx)(x.Z,{onClick:ee,children:"\u6DFB\u52A0\u73AF\u5883"}),children:[(0,e.jsxs)(a.Z,{title:"\u5E94\u7528\u57FA\u7840\u8BE6\u60C5",bordered:!0,children:[(0,e.jsx)(a.Z.Item,{label:"\u5E94\u7528\u540D\u79F0",children:(0,e.jsx)(O,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F"]},style:{display:"inline"},children:(o=u==null?void 0:u.appName)!==null&&o!==void 0?o:"--"})}),(0,e.jsx)(a.Z.Item,{label:"\u4ED3\u5E93",children:(0,e.jsx)(O,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F"]},style:{display:"inline"},children:u==null?void 0:u.repo})}),(0,e.jsx)(a.Z.Item,{label:"\u8BED\u8A00",children:u==null?void 0:u.language}),(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u5206\u652F",children:u==null?void 0:u.defaultBranch}),(0,e.jsx)(a.Z.Item,{label:"\u5F00\u53D1\u6A21\u5F0F",children:u==null?void 0:u.developMode}),(0,e.jsx)(a.Z.Item,{label:"\u90E8\u95E8",children:u==null?void 0:u.department}),(0,e.jsx)(a.Z.Item,{label:"\u90E8\u95E8\u7F29\u5199",children:u==null?void 0:u.departmentAbbreviation}),(0,e.jsx)(a.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:I()(u==null?void 0:u.gmtCreate).format("YYYY-MM-DD HH:mm:ss")}),(0,e.jsx)(a.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:I()(u==null?void 0:u.gmtModified).format("YYYY-MM-DD HH:mm:ss")})]}),(0,e.jsx)("div",{style:{marginTop:"20px"},title:"\u5E94\u7528\u73AF\u5883\u5217\u8868",children:u==null?void 0:u.appEnvList.map(function(l){return(0,e.jsxs)(C.Z,{title:l.envName,extra:(0,e.jsx)("a",{href:"#",children:"More"}),style:{width:300,marginBottom:"16px"},children:[(0,e.jsxs)("p",{children:["\u73AF\u5883: ",l.env]}),(0,e.jsxs)("p",{children:["\u73AF\u5883\u72B6\u6001:"," ",(0,e.jsx)(N.Z,{color:l.status==="1"?"success":"error",children:l.status==="1"?"\u5DF2\u542F\u7528":"\u5DF2\u505C\u7528"})]}),(0,e.jsxs)("div",{style:{marginTop:"16px"},children:[(0,e.jsx)("h5",{children:"\u8D44\u6E90\u7B56\u7565"}),(0,e.jsxs)(a.Z,{colon:!0,column:1,bordered:!0,size:"small",children:[(0,e.jsx)(a.Z.Item,{label:"\u526F\u672C\u6570",children:l.resourceStrategy.replicas}),(0,e.jsx)(a.Z.Item,{label:"CPU",children:l.resourceStrategy.cpu}),(0,e.jsx)(a.Z.Item,{label:"\u5185\u5B58",children:l.resourceStrategy.memory}),(0,e.jsx)(a.Z.Item,{label:"\u6700\u5927CPU",children:l.resourceStrategy.maxCpu}),(0,e.jsx)(a.Z.Item,{label:"\u6700\u5927\u5185\u5B58",children:l.resourceStrategy.maxMemory})]})]})]},l.id)})}),(0,e.jsx)(Y.Z,{title:"\u6DFB\u52A0\u73AF\u5883",width:500,onClose:U,open:J,bodyStyle:{paddingBottom:80},children:(0,e.jsxs)(s.Z,{layout:"vertical",form:q,initialValues:{needApproval:!1,autoScaling:!1},onFinish:ue,children:[(0,e.jsx)(s.Z.Item,{name:"envName",label:"\u73AF\u5883\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0"}],children:(0,e.jsx)(t.Z,{placeholder:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0"})}),(0,e.jsx)(s.Z.Item,{name:"envType",label:"\u73AF\u5883\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73AF\u5883\u7C7B\u578B"}],children:(0,e.jsxs)(j.Z,{placeholder:"\u8BF7\u9009\u62E9\u73AF\u5883\u7C7B\u578B",children:[(0,e.jsx)(p,{value:"\u6D4B\u8BD5",children:"\u6D4B\u8BD5"}),(0,e.jsx)(p,{value:"\u9884\u53D1",children:"\u9884\u53D1"}),(0,e.jsx)(p,{value:"\u7EBF\u4E0A",children:"\u7EBF\u4E0A"})]})}),(0,e.jsx)(s.Z.Item,{name:"clusterId",label:"\u9009\u62E9\u96C6\u7FA4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u96C6\u7FA4"}],children:(0,e.jsx)(j.Z,{placeholder:"\u8BF7\u9009\u62E9\u96C6\u7FA4",children:P&&P.map(function(l){return(0,e.jsxs)(p,{value:l.id,children:[l.clusterName,"(",l.clusterType,")"]},l.id)})})}),(0,e.jsx)(s.Z.List,{name:"domains",rules:[{validator:function(){var l=W()(Z()().mark(function c(F,h){return Z()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(h&&h.length>3)){_.next=2;break}return _.abrupt("return",Promise.reject(new Error("\u6700\u591A\u914D\u7F6E3\u4E2A\u57DF\u540D")));case 2:case"end":return _.stop()}},c)}));function n(c,F){return l.apply(this,arguments)}return n}()}],children:function(n,c,F){var h=c.add,T=c.remove,_=F.errors;return(0,e.jsxs)(e.Fragment,{children:[n.map(function(E,re){return(0,e.jsxs)(s.Z.Item,{style:{width:"100%"},label:re===0?"\u57DF\u540D":"",required:!1,children:[(0,e.jsx)(s.Z.Item,M()(M()({},E),{},{validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"\u8BF7\u8F93\u5165\u5408\u6CD5\u7684\u57DF\u540D"}],noStyle:!0,children:(0,e.jsx)(t.Z,{style:{width:260},placeholder:"\u8BF7\u8F93\u5165\u57DF\u540D"})})),(0,e.jsx)(G.Z,{style:{margin:"0 8px"},className:"dynamic-delete-button",onClick:function(){return T(E.name)}})]},E.key)}),(0,e.jsxs)(s.Z.Item,{children:[(0,e.jsx)(x.Z,{type:"dashed",onClick:function(){return h()},style:{width:"60%"},icon:(0,e.jsx)(H.Z,{}),children:"\u589E\u52A0\u57DF\u540D"}),(0,e.jsx)(s.Z.ErrorList,{errors:_})]})]})}}),(0,e.jsx)(s.Z.Item,{name:"replicas",label:"\u526F\u672C\u6570",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u526F\u672C\u6570"}],children:(0,e.jsx)(t.Z,{type:"number",placeholder:"\u8BF7\u8F93\u5165\u526F\u672C\u6570"})}),(0,e.jsx)(s.Z.Item,{name:"cpu",label:"CPU",rules:[{required:!0,message:"\u8BF7\u8F93\u5165CPU\u6838\u6570"}],children:(0,e.jsx)(t.Z,{placeholder:"\u8BF7\u8F93\u5165CPU\u6838\u6570"})}),(0,e.jsx)(s.Z.Item,{name:"memory",label:"\u5185\u5B58",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5B58\u5927\u5C0F"}],children:(0,e.jsx)(t.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5B58\u5927\u5C0F"})}),(0,e.jsx)(s.Z.Item,{name:"maxCpu",label:"\u6700\u5927CPU",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6700\u5927CPU\u6838\u6570"}],children:(0,e.jsx)(t.Z,{placeholder:"\u8BF7\u8F93\u5165\u6700\u5927CPU\u6838\u6570"})}),(0,e.jsx)(s.Z.Item,{name:"maxMemory",label:"\u6700\u5927\u5185\u5B58",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6700\u5927\u5185\u5B58\u5927\u5C0F"}],children:(0,e.jsx)(t.Z,{placeholder:"\u8BF7\u8F93\u5165\u6700\u5927\u5185\u5B58\u5927\u5C0F"})}),(0,e.jsx)(s.Z.Item,{name:"needApproval",label:"\u53D1\u5E03\u662F\u5426\u5BA1\u6279",rules:[{required:!0}],children:(0,e.jsxs)(d.ZP.Group,{children:[(0,e.jsx)(d.ZP,{value:!0,children:"\u662F"}),(0,e.jsx)(d.ZP,{value:!1,children:"\u5426"})]})}),(0,e.jsx)(s.Z.Item,{name:"autoScaling",label:"\u662F\u5426\u81EA\u52A8\u6269\u5BB9",rules:[{required:!0}],children:(0,e.jsxs)(d.ZP.Group,{children:[(0,e.jsx)(d.ZP,{value:!0,children:"\u662F"}),(0,e.jsx)(d.ZP,{value:!1,children:"\u5426"})]})}),(0,e.jsx)(s.Z.Item,{children:(0,e.jsx)(x.Z,{type:"primary",htmlType:"submit",children:"\u63D0\u4EA4"})})]})})]})};A.default=(0,b.connect)(function(D){var i=D.app,o=D.cluster;return{appDetail:i.appDetail,clusterList:o.clusterList}})(w)}}]);
